import numpy as np

# Input file path and output file path
input_file = "a4_logs_updated.txt"
output_file = "a4_logs_updated1.txt"

# List of new run numbers to check and add
run_list = [2976, 2977, 2978, 2979, 2980, 2981, 2982, 2986, 2989, 2991, 2992, 2994, 2997, 2999, 3000, 3001, 3002, 3003, 3008, 3009, 3011, 3012, 3013, 3014, 3015, 3016, 3017, 3019, 3020, 3022, 3024, 3040, 3042, 3043, 3044, 3048, 3053, 3055, 3057, 3062, 3064, 3067, 3068, 3069, 3072, 3073, 3074, 3075, 3076, 3078, 3080, 3082, 3084, 3086, 3090, 3092, 3094, 3096, 3098, 3104, 3108, 3110, 3118, 3120, 3122, 3126, 3131, 3132, 3133, 3134, 3135, 3136, 3137, 3138, 3139, 3140, 3141, 3142, 3143, 3144, 3145, 3146, 3148, 3150, 3151, 3152, 3154, 0, 3163, 3164, 3172, 3174, 3175, 3177, 3179, 3181, 3183, 3186, 3187, 3188, 3190, 3194, 3197, 3203, 3205, 3209, 3217, 3236, 3240, 3245, 3246, 3249, 3250, 3254, 3255, 3256, 3257, 3258, 3259, 3262, 3263, 3264, 3266, 3267, 3268, 3270, 3271, 3272, 3273, 3275, 3277, 3279, 3282, 3283, 3251, 3252, 3294, 3298, 3301, 3305, 3307, 3311, 3924, 3925, 3926, 2984, 2985, 2987, 2988, 2990, 2995, 2996, 3004, 3005, 3006, 3007, 3010, 3018, 3021, 3023, 3025, 3026, 3027, 3028, 3029, 3030, 3031, 3037, 3038, 3039, 3041, 3045, 3046, 3047, 3049, 3050, 3051, 3052, 3054, 3056, 3061, 3065, 3066, 3070, 3071, 3088, 3100, 3102, 3106, 3112, 3114, 3116, 3124, 3128, 3147, 3149, 3153, 3155, 3156, 3165, 3166, 3168, 3169, 3170, 3171, 3176, 3178, 3184, 3185, 3189, 3191, 3192, 3193, 3195, 3196, 3207, 3211, 3218, 3220, 3224, 3225, 3226, 3227, 3228, 3229, 3230, 3238, 3239, 3241, 3242, 3247, 3248, 3261, 3265, 3269, 3274, 3276, 3278, 3280, 3281, 3284, 3286, 3288, 3289, 3290, 3291, 3292, 3293, 3297, 3299, 3302, 3303, 3309, 3327, 3328, 3332, 3374, 3403, 3441, 3442, 3470, 3513, 3524, 3531, 3532, 3535, 3536, 3537, 3577, 3601, 3614, 3780, 3795, 3835, 4034, 4053, 4057, 4109, 4115, 4164, 4317, 4381, 4386, 4388, 4412, 4439, 4440, 4442, 4444, 4564, 4619, 4625, 4631, 4638, 4640, 4655, 4665, 4666, 4678, 4680, 4702, 4708, 4731, 4733, 4739, 4748, 4754, 4759, 4783, 4799, 4808, 4828, 4831, 4833, 4862, 4863, 4868, 4873, 4916, 4943, 4946, 4947, 4959, 4964, 4979, 4987, 5008, 5009, 5010, 5031, 5047, 5054, 5080, 5084, 5085, 5108, 5150, 5155, 5158, 5169, 5193, 5200, 5201, 5205, 5215, 5225, 5229, 5248, 5254, 5268, 5270, 5274, 5278, 5287, 5304, 5308, 5312, 5329, 5340, 5346, 5354, 5365, 5366, 5367, 5368, 5369, 5370, 5371, 5372, 5373, 5374, 5375, 5376, 5377, 5378, 5379, 5380, 5381, 5382, 5383, 5384, 5385, 5386, 5419, 5421, 5422, 5441, 5443, 5451, 5455, 5457, 5467, 5468, 5470, 5471, 5472, 5473, 5475, 5478, 5479, 5480, 5487, 5569, 5575, 5576, 5583, 5585, 5703, 5851, 5852, 5880, 4632, 5476, 5481, 5483, 5485, 5486, 5488, 5489, 5490, 5939, 5994, 6000, 6048, 6072, 6073, 6146, 6258, 6726, 6773, 6867, 6892, 7283, 7327, 7447, 7481, 7796, 7978, 8042, 8062, 8078, 8118, 8372, 8572, 8667, 8772, 8838, 8866, 9080, 9119, 9127, 9130, 9132, 9133, 9134, 9135, 9136, 9137, 9138, 9139, 9174, 9208, 9215, 9250, 9252, 9254, 9351, 9531, 9861, 10268, 10281, 10456, 10458, 10479, 10482, 10603, 11215, 11251, 11255, 11282, 11301, 11423, 11629, 11761, 11894, 11943, 12132, 12223, 12262, 12348, 12352] 

# Step 1: Read the existing file and clean up formatting
existing_runs = {}  # Dictionary to store runs and their cleaned lines
with open(input_file, "r") as file:
    for line in file:
        parts = line.strip().split()
        if len(parts) >= 4:  # Ensure valid format with at least 4 columns
            run_number = int(parts[0])
            # Ensure tabs are used for separation
            cleaned_line = f"{parts[0]}\t{parts[1]}\t{parts[2]}\t{' '.join(parts[3:])}"
            existing_runs[run_number] = cleaned_line

# Step 2: Add missing runs with consistent formatting
for run in run_list:
    if run not in existing_runs:  # Add missing runs
        if run <6188:
           year = 2018
        elif 6188<run<9207:
           year = 2019
        elif 9207<run<12227:
           year = 2020 
        else:
           year = 2021
        new_entry = f"{run}\tpawangiri\tcalibration\t{year} calibration"
        existing_runs[run] = new_entry

# Step 3: Sort the data by run number
sorted_runs = sorted(existing_runs.items())  # Sort by run number

# Step 4: Write back to a new file with tabs ensured
with open(output_file, "w") as file:
    for _, line in sorted_runs:
        file.write(f"{line}\n")

print(f"Updated file saved as: {output_file}")

